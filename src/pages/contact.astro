---
import Layout from "../layouts/Layout.astro";
---

<Layout
  title="Contact Us | Kinga Dow - Retention Marketing Agency"
  description="Get in touch with Kinga Dow for expert retention marketing services. Email marketing, SMS marketing, and loyalty program solutions for e-commerce brands."
>
  <!-- Hero Section -->
  <section class="hero-gradient relative py-10 md:py-16 overflow-hidden">
    <!-- Decorative circle pattern - left side -->
    <div class="absolute -left-20 top-16 w-[380px] h-[380px] opacity-30 pointer-events-none">
      <img src="/images/home/decorative/bg-circle-left.png" alt="" class="w-full h-full object-contain" aria-hidden="true" />
    </div>
    <!-- Decorative circle pattern - bottom right -->
    <div class="absolute -right-16 -bottom-16 w-[300px] h-[300px] opacity-20 pointer-events-none">
      <img src="/images/home/decorative/bg-circle.png" alt="" class="w-full h-full object-contain" aria-hidden="true" />
    </div>

    <div class="max-w-6xl mx-auto px-6 text-center relative z-10">
      <!-- Label: Gold uppercase -->
      <span class="animate-on-scroll fade-in-up font-aktiv text-kd-gold font-medium text-[14px] leading-[17px] tracking-[1.4px] mb-4 block uppercase">
        Contact us
      </span>

      <!-- Headline -->
      <h1 class="animate-on-scroll fade-in-up delay-100 font-aktiv text-kd-navy text-[32px] md:text-[48px] leading-[40px] md:leading-[58px] tracking-[1.6px] md:tracking-[2.4px] font-semibold max-w-3xl mx-auto mb-6">
        Get in touch!
      </h1>

      <!-- Subheadline -->
      <p class="animate-on-scroll fade-in-up delay-200 font-montserrat text-black text-[16px] md:text-[18px] leading-[26px] md:leading-[30px] tracking-[1.6px] md:tracking-[1.8px] font-light max-w-2xl mx-auto mb-6">
        We'd love to hear about your eCommerce project and how we can help your business grow with our strategic email and SMS marketing tactics. Complete the form, and Kinga Dow will personally be in touch in the next 1 â€“ 2 business days.
      </p>

      <!-- Contact Info Cards -->
      <div class="animate-on-scroll fade-in-up delay-400 grid grid-cols-1 md:grid-cols-3 gap-8 md:gap-12 max-w-3xl mx-auto">
        <!-- Location -->
        <div class="flex flex-col items-center">
          <div class="w-16 h-16 md:w-20 md:h-20 rounded-full border-2 border-kd-gold/40 flex items-center justify-center mb-4">
            <svg class="w-7 h-7 md:w-8 md:h-8 text-kd-gold" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
            </svg>
          </div>
          <p class="font-montserrat text-kd-navy text-[14px] md:text-[16px] tracking-[0.7px] font-medium">
            Paris, France
          </p>
        </div>

        <!-- Phone -->
        <div class="flex flex-col items-center">
          <div class="w-16 h-16 md:w-20 md:h-20 rounded-full border-2 border-kd-gold/40 flex items-center justify-center mb-4">
            <svg class="w-7 h-7 md:w-8 md:h-8 text-kd-gold" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" />
            </svg>
          </div>
          <a href="tel:+33767054040" class="font-montserrat text-kd-navy text-[14px] md:text-[16px] tracking-[0.7px] font-medium hover:text-kd-gold transition-colors">
            +33 7 67 05 40 40
          </a>
        </div>

        <!-- Email -->
        <div class="flex flex-col items-center">
          <div class="w-16 h-16 md:w-20 md:h-20 rounded-full border-2 border-kd-gold/40 flex items-center justify-center mb-4">
            <svg class="w-7 h-7 md:w-8 md:h-8 text-kd-gold" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
            </svg>
          </div>
          <a href="mailto:kinga@kingadow.com" class="font-montserrat text-kd-navy text-[14px] md:text-[16px] tracking-[0.7px] font-medium hover:text-kd-gold transition-colors">
            kinga@kingadow.com
          </a>
        </div>
      </div>
    </div>
  </section>

  <!-- Contact Form Section -->
  <section class="py-8 md:py-12 px-6 bg-white">
    <div class="max-w-4xl mx-auto">
      <!-- Form -->
      <form id="contact-form" class="animate-on-scroll fade-in-up delay-100">
        <div class="grid md:grid-cols-2 gap-6 md:gap-8">
          <!-- Left Column: Name, Email, Phone -->
          <div class="space-y-5">
            <!-- Name -->
            <div>
              <label for="contact-name" class="block text-kd-gold text-[12px] md:text-[13px] font-montserrat font-medium tracking-[1.2px] uppercase mb-2">
                Name
              </label>
              <input
                type="text"
                id="contact-name"
                name="name"
                placeholder="Enter your name"
                required
                class="w-full px-5 py-3.5 rounded-lg border border-gray-200 bg-kd-cream/30 focus:outline-none focus:border-kd-gold focus:bg-white text-[15px] font-montserrat font-light text-kd-navy placeholder:text-gray-400 transition-all"
              />
            </div>

            <!-- Email -->
            <div>
              <label for="contact-email" class="block text-kd-gold text-[12px] md:text-[13px] font-montserrat font-medium tracking-[1.2px] uppercase mb-2">
                Email Address
              </label>
              <input
                type="email"
                id="contact-email"
                name="email"
                placeholder="email@gmail.com"
                required
                class="w-full px-5 py-3.5 rounded-lg border border-gray-200 bg-kd-cream/30 focus:outline-none focus:border-kd-gold focus:bg-white text-[15px] font-montserrat font-light text-kd-navy placeholder:text-gray-400 transition-all"
              />
            </div>

            <!-- Phone -->
            <div>
              <label for="contact-phone" class="block text-kd-gold text-[12px] md:text-[13px] font-montserrat font-medium tracking-[1.2px] uppercase mb-2">
                Phone Number
              </label>
              <input
                type="tel"
                id="contact-phone"
                name="phone"
                placeholder="+01 234 75 63 11"
                class="w-full px-5 py-3.5 rounded-lg border border-gray-200 bg-kd-cream/30 focus:outline-none focus:border-kd-gold focus:bg-white text-[15px] font-montserrat font-light text-kd-navy placeholder:text-gray-400 transition-all"
              />
            </div>
          </div>

          <!-- Right Column: Message -->
          <div class="h-full">
            <label for="contact-message" class="block text-kd-gold text-[12px] md:text-[13px] font-montserrat font-medium tracking-[1.2px] uppercase mb-2">
              Message
            </label>
            <textarea
              id="contact-message"
              name="message"
              placeholder="Your Message"
              rows="8"
              class="w-full h-[calc(100%-28px)] min-h-[180px] px-5 py-3.5 rounded-lg border border-gray-200 bg-kd-cream/30 focus:outline-none focus:border-kd-gold focus:bg-white text-[15px] font-montserrat font-light text-kd-navy resize-none placeholder:text-gray-400 transition-all"
            ></textarea>
          </div>
        </div>

        <!-- Services Selection -->
        <div class="mt-8">
          <label class="block text-kd-gold text-[12px] md:text-[13px] font-montserrat font-medium tracking-[1.2px] uppercase mb-4">
            Services
          </label>
          <div class="flex flex-wrap gap-3">
            <button
              type="button"
              data-service="Email Marketing"
              class="service-pill px-5 py-2.5 rounded-full border border-kd-gold text-kd-gold text-[13px] md:text-[14px] font-montserrat font-medium tracking-[0.7px] hover:bg-kd-gold hover:text-white transition-all"
            >
              Email Marketing
            </button>
            <button
              type="button"
              data-service="SMS Marketing"
              class="service-pill px-5 py-2.5 rounded-full border border-kd-gold text-kd-gold text-[13px] md:text-[14px] font-montserrat font-medium tracking-[0.7px] hover:bg-kd-gold hover:text-white transition-all"
            >
              SMS Marketing
            </button>
            <button
              type="button"
              data-service="Loyalty Program"
              class="service-pill px-5 py-2.5 rounded-full border border-kd-gold text-kd-gold text-[13px] md:text-[14px] font-montserrat font-medium tracking-[0.7px] hover:bg-kd-gold hover:text-white transition-all"
            >
              Loyalty Program
            </button>
          </div>
          <!-- Hidden input to store selected services -->
          <input type="hidden" id="selected-services" name="services" value="" />
        </div>

        <!-- Submit Button -->
        <div class="mt-8 flex justify-center">
          <button
            type="submit"
            id="contact-submit-btn"
            class="btn-navy py-5 px-32 rounded-lg text-[16px] md:text-[18px] font-montserrat font-medium tracking-[1.6px] uppercase flex items-center justify-center gap-3"
          >
            <span id="contact-submit-text">SUBMIT</span>
          </button>
        </div>
      </form>

      <!-- Success Message -->
      <div id="contact-success" class="hidden text-center py-12">
        <div class="w-16 h-16 mx-auto mb-6 rounded-full bg-kd-gold/10 flex items-center justify-center">
          <svg class="w-8 h-8 text-kd-gold" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
          </svg>
        </div>
        <h3 class="font-aktiv text-kd-navy text-[24px] md:text-[28px] font-semibold tracking-[1.2px] mb-3">
          Thank You!
        </h3>
        <p class="font-montserrat text-kd-grey text-[15px] md:text-[16px] leading-[24px] tracking-[0.75px] font-light">
          We've received your message and will be in touch soon.
        </p>
      </div>
    </div>
  </section>
</Layout>

<style>
  .service-pill.active {
    background-color: #BA9200;
    color: white;
  }
</style>

<script>
  // Service pill toggle
  const servicePills = document.querySelectorAll('.service-pill');
  const selectedServicesInput = document.getElementById('selected-services') as HTMLInputElement;
  const selectedServices: string[] = [];

  servicePills.forEach(pill => {
    pill.addEventListener('click', () => {
      const service = pill.getAttribute('data-service');
      if (!service) return;

      pill.classList.toggle('active');

      const index = selectedServices.indexOf(service);
      if (index > -1) {
        selectedServices.splice(index, 1);
      } else {
        selectedServices.push(service);
      }

      selectedServicesInput.value = selectedServices.join(', ');
    });
  });

  // Form submission to Klaviyo
  const form = document.getElementById('contact-form');

  form?.addEventListener('submit', async (e) => {
    e.preventDefault();

    const name = (document.getElementById('contact-name') as HTMLInputElement).value;
    const email = (document.getElementById('contact-email') as HTMLInputElement).value;
    const phone = (document.getElementById('contact-phone') as HTMLInputElement).value;
    const message = (document.getElementById('contact-message') as HTMLTextAreaElement).value;
    const services = selectedServicesInput.value;
    const submitBtn = document.getElementById('contact-submit-btn') as HTMLButtonElement;
    const submitText = document.getElementById('contact-submit-text') as HTMLSpanElement;
    const successMsg = document.getElementById('contact-success') as HTMLDivElement;

    // Disable button and show loading
    submitBtn.disabled = true;
    submitText.textContent = 'Sending...';

    try {
      // Subscribe to Klaviyo list W3XhAb with form UMVMhn
      await fetch('https://a.klaviyo.com/client/subscriptions/', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'revision': '2024-10-15',
        },
        body: JSON.stringify({
          data: {
            type: 'subscription',
            attributes: {
              profile: {
                data: {
                  type: 'profile',
                  attributes: {
                    email: email,
                    first_name: name.split(' ')[0],
                    last_name: name.split(' ').slice(1).join(' ') || '',
                    phone_number: phone || undefined,
                    properties: {
                      contact_message: message,
                      contact_services: services,
                      contact_request: true,
                      source: 'website_contact_form',
                    },
                  },
                },
              },
              custom_source: 'Contact Form',
            },
            relationships: {
              list: {
                data: {
                  type: 'list',
                  id: 'W3XhAb',
                },
              },
            },
          },
        }),
      });

      // Show success
      form.classList.add('hidden');
      successMsg.classList.remove('hidden');

    } catch (error) {
      // Show error
      submitText.textContent = 'Something went wrong. Try again.';
      submitBtn.disabled = false;
      setTimeout(() => {
        submitText.textContent = 'SUBMIT';
      }, 3000);
    }
  });
</script>
